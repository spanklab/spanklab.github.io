<h1>Вход</h1>
<div class="notice"></div>
<form method="post" class="ajax_login_form" action="/?do=ajax&action=ajax_login">
<table>
<tbody><tr>
<td>Логин</td>
<td><input type="text" value="" id="login" name="login" class="input"></td>
</tr>
<tr>
<td>Пароль</td>
<td><input type="text" value="" id="password" name="password" class="input"></td>
</tr>
<tr>
<td></td>
<td><input type="submit" value="Вход" class="input_submit"></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><br/><a  style="color:#323232;text-decoration:underline;" class="various fancybox.ajax remind_link" href="/ajax_reminder">Забыли пароль?</a></td>
</tr>
</tbody></table>
</form>
<script>
$(".ajax_login_form").submit(function(e)
{
    var postData = $(this).serializeArray();
    var formURL = $(this).attr("action");
	var error = false;
	$('.notice').fadeOut();
	if( $('#login').val().length == 0 ) {
        $('.notice').text('Введите логин и пароль').fadeIn();
		error = true;
    }
	if( $('#password').val().length == 0 ) {
        $('.notice').text('Введите логин и пароль').fadeIn();
		error = true;
    }
	if(!error){
    $.ajax(
    {
        url : formURL,
        type: "POST",
        data : postData,
        success:function(data, textStatus, jqXHR) 
        {
		if(data=='ok'){
			document.location = document.location
		}
		else{
			$('.notice').text('Неверный логин или пароль!').fadeIn();
			
		
		}
            //data: return data from server
        },
        error: function(jqXHR, textStatus, errorThrown) 
        {
            //if fails      
        }
    });
	}
    e.preventDefault(); //STOP default action
	
   // e.unbind(); //unbind. to stop multiple form submit.
});
</script>
